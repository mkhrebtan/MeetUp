<div class="p-8 max-w-4xl mx-auto">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-foreground">Workspace Settings</h1>
    <p class="text-muted-foreground mt-1">Manage your workspace preferences and permissions</p>
  </div>

  @let userRole = userRole$ | async;
  <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()" class="space-y-8">
    <p-card class="px-2">
      <div class="py-4 pt-1 space-y-1">
        <div class="flex items-center gap-2 mb-2">
          <i class="pi pi-building text-primary" style="font-size: 1.25rem"></i>
          <h3 class="font-semibold text-lg">General</h3>
        </div>
      </div>

      <div class="space-y-4">
        <div class="grid gap-2">
          <label class="font-semibold text-foreground" for="name">Workspace Name</label>
          <input formControlName="name" fluid pInputText pSize="small" type="text" id="name" [readonly]="userRole !== 'Admin'" />
        </div>
      </div>
    </p-card>

    <p-card class="px-2">
      <div class="py-4 pt-1 space-y-1">
        <div class="flex items-center gap-2 mb-2">
          <i class="pi pi-shield text-primary" style="font-size: 1.25rem"></i>
          <h3 class="font-semibold text-lg">Permissions</h3>
        </div>
      </div>

      <div class="space-y-4">
        <div class="flex items-center justify-between">
          <div class="space-y-0.5">
            <label class="text-base font-semibold text-foreground" for="recording">Meetings Creation</label>
            <p class="text-sm text-muted-foreground">Who can create meetings</p>
          </div>
          <p-select size="small" id="recording" formControlName="meetingsCreationPolicy" [options]="meetingsCreationPolicyOptions" [disabled]="userRole !== 'Admin'" />
        </div>

        <div class="h-px w-full bg-border mt-6 mb-6"></div>

        <div class="flex items-center justify-between">
          <div class="space-y-0.5">
            <label class="text-base font-semibold text-foreground" for="invitations">Invitations</label>
            <p class="text-sm text-muted-foreground">Who can invite new members to the workspace</p>
          </div>
          <p-select size="small" id="invitations" formControlName="invitationPolicy" [options]="invitationPolicyOptions" [disabled]="userRole !== 'Admin'"/>
        </div>
      </div>
    </p-card>

    <div class="flex justify-end gap-4">
      <p-button label="Cancel" severity="contrast" size="small" variant="outlined" [disabled]="!settingsChanged()" (click)="onCancel()"/>
      <p-button label="Save Changes" severity="primary" size="small" [disabled]="!settingsChanged()" type="submit"/>
    </div>

    <div class="h-px w-full bg-border mt-6 mb-6"></div>

    <div class="space-y-4">
      <h3 class="text-lg font-semibold text-destructive">Danger Zone</h3>
      <div
        class="text-card-foreground flex flex-col gap-6 rounded-xl border shadow-sm border-destructive/20 bg-destructive/5"
      >
        <div class="p-6 space-y-4">
          <div class="flex items-center justify-between">
            <div class="space-y-1">
              <h4 class="font-medium">Leave Workspace</h4>
              <p class="text-sm text-muted-foreground">
                Revoke your access to this workspace. You can be invited back later.
              </p>
            </div>
            <p-button
              icon="pi pi-sign-out"
              label="Leave"
              severity="danger"
              size="small"
              variant="outlined"
              (click)="onLeave()"
            />
          </div>

          @if (userRole === 'Admin') {
              <div class="h-px w-full bg-border mt-6 mb-6"></div>

              <div class="flex items-center justify-between">
                <div class="space-y-1">
                  <h4 class="font-medium">Delete Workspace</h4>
                  <p class="text-sm text-muted-foreground">
                    Permanently delete this workspace and all associated data. This cannot be undone.
                  </p>
                </div>
                <p-button icon="pi pi-trash" label="Delete Workspace" severity="danger" size="small" (click)="onDelete()" />
              </div>
            }
        </div>
      </div>
    </div>
  </form>
</div>
